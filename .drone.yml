kind: pipeline
type: docker
name: gotil

platform:
  os: linux
  arch: amd64

steps:
  - name: ci_1.13
    image: golang:1.13
    environment:
      GO111MODULE: "on"
      GOPROXY: "https://goproxy.cn,direct"
      GOSUMDB: "off"
      CGO_ENABLED: "0"
      GOOS: "linux"
    commands:
      - go version
      - go env
      - go mod tidy
      - go test ./...

  - name: ci_1.14
    image: golang:1.14
    environment:
      GO111MODULE: "on"
      GOPROXY: "https://goproxy.cn,direct"
      GOSUMDB: "off"
      CGO_ENABLED: "0"
      GOOS: "linux"
    commands:
      - go version
      - go env
      - go mod tidy
      - go test ./...

  - name: ci_1.15
    image: golang:1.15
    environment:
      GO111MODULE: "on"
      GOPROXY: "https://goproxy.cn,direct"
      GOSUMDB: "off"
      CGO_ENABLED: "0"
      GOOS: "linux"
    commands:
      - go version
      - go env
      - go mod tidy
      - go test ./...

trigger:
  branch:
    - master
  event:
    - push
    - pull_request
    - tag
